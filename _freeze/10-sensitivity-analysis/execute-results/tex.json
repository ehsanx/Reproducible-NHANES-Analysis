{
  "hash": "2feeb8eae2da1f3d0ba307e4c702ab35",
  "result": {
    "markdown": "# Sensitivity Analyses\n\n---\n\nThis chapter presents several analyses conducted to further assess and understand the primary findings regarding association between early-smoking initiation and mortality. It includes two sensitivity analyses and one exploratory analysis of a potential mediator.\n\n-   **Adjustment for Socioeconomic Status (SES) Proxies:** This analysis investigates whether the observed associations are substantially influenced by socioeconomic factors. This is achieved by adjusting for additional variables, such as family poverty income ratio (PIR), which compares household income to the poverty threshold adjusted for household size and composition (NHANES variable INDFMPIR) , and the education level of the household head (NHANES variable DMDHREDU). These variables serve as proxies for family socioeconomic status.\n\n-   **Effect Modification by Race/Ethnicity (2011-2018):** This analysis examines how findings might vary when considering the \"non-Hispanic Asian\" racial classification, which was introduced in the 2011 survey cycle. It focuses on effect modification by race/ethnicity within the survey cycles spanning 2011 to 2018, which incorporate the Asian race/ethnicity category.\n\n-   **Exploratory Analysis of Smoking Duration:** This analysis investigates the relationship between the age of smoking initiation and the total duration of smoking, a potential mediator in the pathway to mortality.\n\nThe key methods and the paper figures/tables they reproduce are summarized below:\n\n| Analysis | Purpose | Key Method | Reproduces |\n| :--- | :--- | :--- | :--- |\n| **Adjustment for SES Proxies** | To test if the main findings are robust to confounding by socioeconomic status. | Added `pir` (income) and `HHedu` (education) as covariates to the adjusted Cox model. | [**Appendix Figure 5**](10-sensitivity-analysis.html#visualizing-the-ses-adjusted-results) |\n| **Effect Modification by Race (2011-2018)** | To specifically investigate the association within the non-Hispanic Asian population. | Subset the data to the 2011-2018 cycles and included the `race2` variable (with the 'Asian' category) in the effect modification model. | [**Appendix Table 3**](10-sensitivity-analysis.html#analysis-of-the-2011-2018-sub-period) and [**Appendix Figure 4**](10-sensitivity-analysis.html#visualizing-the-sub-period-results) |\n| **Smoking Duration** | Explore if earlier initiation is linked to longer smoking duration. | Create boxplots of smoking duration stratified by initiation age. | [**Appendix Figures 1-3**](10-sensitivity-analysis.html#visualizing-smoking-duration-by-initiation-age) |\n\n\n\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/libraries_33238ee11abbb3b71330ddff8f0dd481'}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(readr)\nlibrary(car)\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(DataExplorer)\nlibrary(tableone)\nlibrary(Publish)\nlibrary(survey)\noptions(survey.want.obsolete=TRUE)\nlibrary(survival)\nrequire(knitr)\nrequire(kableExtra)\nrequire(stringr) \nlibrary(ggplot2) \nlibrary(expss) \nlibrary(readxl) \nlibrary(patchwork)\nlibrary(forcats)\nlibrary(nhanesA)\n```\n:::\n\n\n\n\n\n## Sensitivity Analysis 1: Adjustment for SES Proxies\n\n### Data Reprocessing with SES Variables\n\nOur primary analysis did not include socioeconomic status (SES) variables because they had a high number of missing values. To ensure these factors were not confounding our results, we performed this sensitivity analysis. This required reprocessing the raw NHANES data to create a new dataset that includes the following 2 variables as well:\n\nDemographics:\n\n-   **\"INDFMPIR\": Ratio of family income to poverty (family SES)**\n-   **\"DMDHREDU\": Education level of the household head (family SES)**\n\n---\n\n* R Code Chunk 1: Data Reprocessing and Cleaning with SES Variables\n\nThe code steps for data downloading, cleaning, and merging are nearly identical to the process in main analysis. The key new data preparation steps for this sensitivity analysis are the cleaning of the two SES proxy variables, pir and HHedu.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/load_f0e850e44789ad983fc573bbad12cc1d'}\n\n```{.r .cell-code}\n# File Names\ndemo <- c(\"DEMO\", \"DEMO_B\", \"DEMO_C\", \"DEMO_D\", \"DEMO_E\", \n          \"DEMO_F\", \"DEMO_G\", \"DEMO_H\", \"DEMO_I\", \"DEMO_J\")\nsmoking <- c(\"SMQ\", \"SMQ_B\", \"SMQ_C\", \"SMQ_D\", \"SMQ_E\",\n             \"SMQ_F\", \"SMQ_G\", \"SMQ_H\", \"SMQ_I\", \"SMQ_J\")\n\n# 10 Data Files\ndemo_data_files <- readRDS(\"data/demo_data_files.rds\")\nsmoking_data_files <- readRDS(\"data/smoking_data_files.rds\")\n\n# Set Columns\ndemo_columns <- c( \"SEQN\", \"RIDAGEYR\", \"RIAGENDR\", \"RIDRETH1\",\n                   \"INDFMPIR\", \"DMDHREDU\", \"DMDHREDZ\", # *** these are new\n                   \"DMDBORN\", \"DMDBORN2\", \"DMDBORN4\", \"SDDSRVYR\", \n                   \"WTINT2YR\", \"WTMEC2YR\", \"SDMVPSU\", \"SDMVSTRA\")\nsmoking_columns <- c(\"SEQN\", \"SMQ020\", \"SMD030\", \"SMQ040\", \"SMD055\")\n\n\n# DEMOGRAPHICS\ndemo_data_files_2 <- lapply(seq_along(demo_data_files), function(i) \n  {\n  current_cycle_data <- demo_data_files[[i]]\n  original <- demo[i] \n  \n  # Select Columns\n  subset_data <- current_cycle_data %>% \n    dplyr::select(dplyr::any_of(demo_columns))\n  # Translate \n  translated_data <- nhanesTranslate(original,\n                                     names(subset_data), \n                                     data = subset_data)\n  # Return\n  return(translated_data) \n})\n\n\n# SMOKING\nsmoking_data_files_2 <- lapply(seq_along(smoking_data_files), function(i) \n  {\n  current_cycle_data <- smoking_data_files[[i]]\n  original <- smoking[i]\n\n  # Select Columns\n  subset_data <- current_cycle_data %>%\n    dplyr::select(dplyr::any_of(smoking_columns))\n  # Translate\n  translated_data <- nhanesTranslate(original, \n                                     names(subset_data), \n                                     data = subset_data)\n  # Return\n  return(translated_data)\n})\n\n\n# MERGE\ndata_all <- lapply(seq_along(demo_data_files_2), function(i) {\n  demo_df <- demo_data_files_2[[i]]\n  smoking_df <- smoking_data_files_2[[i]]\n  \n  # Merge by SEQN\n  merged_df <- join_all(list(demo_df, smoking_df), \n                        by = \"SEQN\", \n                        type = 'full')\n  return(merged_df)\n})\n\n\n# Rename \ndata_all2 <- data_all\nfor (i in seq_along(data_all2)) {\n  df <- as.data.frame(data_all2[[i]])\n\n  if (\"DMDBORN2\" %in% names(df)) {\n    names(df)[names(df) == \"DMDBORN2\"] <- \"DMDBORN\"\n  } else if (\"DMDBORN4\" %in% names(df)) {\n    names(df)[names(df) == \"DMDBORN4\"] <- \"DMDBORN\"\n  }\n  data_all2[[i]] <- df\n}\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/cleaning_1aed3b7398c2e8b296911b461c884532'}\n\n```{.r .cell-code}\n\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  ## ID\n  dat2$id <- dat2$SEQN\n  \n  ## Demographic\n    ### Age (for eligibility)\n  dat2$age <- dat2$RIDAGEYR\n  \n    ### Sex\n  dat2$sex <- dat2$RIAGENDR\n  \n    ### Race/Ethnicity\n  dat2$race <- dat2$RIDRETH1\n  dat2$race <- car::recode(dat2$race, recodes = \"\n    'Non-Hispanic White'='White';\n    'Non-Hispanic Black'='Black';\n    c('Mexican American','Other Hispanic')='Hispanic';\n    else='Others'\")\n  dat2$race <- factor(dat2$race, \n                      levels = c(\"White\", \"Black\", \"Hispanic\", \"Others\"))\n  \n    ### Country of birth\n  dat2$born <- dat2$DMDBORN\n  dat2$born <- car::recode(dat2$born, recodes = \"\n    c('Born in Mexico','Born Elsewhere', 'Others') = 'Other place';\n    c('Born in 50 US States or Washington, DC', 'Born in 50 US states or Washington, DC') = 'Born in US';\n    else = NA\")\n  dat2$born <- factor(dat2$born, \n                      levels = c(\"Born in US\", \"Other place\"))\n  \n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n**Poverty Income Ratio:** The poverty income ratio (INDFMPIR) is provided as a continuous variable. To make it easier to use in our models, the following code uses the `cut()` function to categorize the numeric ratio into five distinct, interpretable groups, from \"Below Poverty Line\" to \"High Income.\"\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/PIR_d4cdffaeea0fc7fdfd271ee4ecb16bab'}\n\n```{.r .cell-code}\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  # Set Poverty Income Ratio\n  dat2$pir <- dat2$INDFMPIR\n  \n  # Cut into five distinct groups\n  dat2$pir <- cut(dat2$pir,\n                  breaks = c(-Inf, 1, 1.99, 3.99, 4.99, Inf),\n                  labels = c(\"Below Poverty Line\",\n                             \"Near Poverty Line\",\n                             \"Low to Middle Income\",\n                             \"Middle to High Income\",\n                             \"High Income\"),\n                  right = FALSE)\n  \n  # Return\n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n**Household Head Education Level:** The coding for household head education also changes over the survey years, with the 2017-2018 cycle using a different variable name (DMDHREDZ) and different text labels. The code below uses an if-else statement to handle this inconsistency. It applies one set of recoding rules for the first nine cycles and a different set for the final 2017-2018 cycle, ensuring the final HHedu variable is harmonized across all datasets.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/edu_faec2c9d6e4e517ac3cada1b28f31745'}\n\n```{.r .cell-code}\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  if (i < 10) {\n  \n  # Set Education Level of the Household Head\n  # Now, use case_when() for robust recoding\n  dat2$HHedu <- case_when(\n    dat2$DMDHREDU %in% c(\"Less Than 9th Grade\", \"9-11th Grade (Includes 12th grade with no diploma)\", \"Less than high school degree\") ~ \"Less than high school\",\n    dat2$DMDHREDU %in% c(\"High School Grad/GED or equivalent\", \"Some College or AA degree\", \"High school grad/GED or some col\") ~ \"High school or college\",\n    dat2$DMDHREDU == \"College Graduate or above\" ~ \"College graduate or above\",\n    TRUE ~ NA_character_ # This handles \"Refused\", \"Don't know\", and any other non-matches\n    )\n  \n  # Convert to a factor with the correct levels\n  dat2$HHedu <- factor(dat2$HHedu, levels = c('Less than high school',\n                                              'High school or college', \n                                              'College graduate or above'))\n  # Return\n  data_all2[[i]] <- dat2\n  }\n  \n  # For the 10th dataset (2017-2018)\n  else { \n    dat2$HHedu <- as.character(dat2$DMDHREDZ)\n    dat2$HHedu <- dplyr::recode(dat2$HHedu,\n                         `Less than high school degree` = 'Less than high school',\n                         `High school grad/GED or some college/AA degree` = 'High school or college',\n                         `College graduate or above` = 'College graduate or above',\n                         .default = NA_character_ \n                         #`Refused` = NA_character_,\n                         #`Don't know` = NA_character_\n                         )\n    dat2$HHedu <- factor(dat2$HHedu, levels = c('Less than high school',\n                                                'High school or college',\n                                                'College graduate or above'))\n    \n    # Return\n    data_all2[[i]] <- dat2\n    }\n}\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/cleaning2_91993fbcd4385aaf3dd7c3c9998057df'}\n\n```{.r .cell-code}\n# Remaining Variables\n\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  ## Smoking\n    ### Status\n  dat2$smoking <- dat2$SMQ020\n  dat2$smoking <- car::recode(dat2$smoking, \" 'Yes' = 'Current smoker'; 'No' = 'Never smoker'; else=NA  \")\n  dat2$smoking <- factor(dat2$smoking, levels = c(\"Never smoker\", \"Previous smoker\", \"Current smoker\"))\n  dat2$smoking[dat2$SMQ040 == \"Not at all?\" | dat2$SMQ040 == \"Not at all\"] <- \"Previous smoker\"\n  \n    ### Age smoking started\n  dat2$smoking.age <- dat2$SMD030\n  dat2$smoking.age[dat2$smoking.age == 777] <- NA\n  dat2$smoking.age[dat2$smoking.age == 999] <- NA\n  dat2$smoking.age[dat2$smoking == \"Never smoker\"] <- 99 # 99 means never smoker\n  \n    ### Whether smoking started age of 15 or before\n  dat2$smoked.while.child <- car::recode(dat2$smoking.age, \" 0 = 'No'; 1:15 = 'Yes'; else = NA \", as.factor = T)\n  \n  ## Survey features\n    ### Weight\n  dat2$survey.weight <- dat2$WTINT2YR #WTMEC2YR # MEC weights\n  \n    ### PSU \n  dat2$psu <- as.factor(dat2$SDMVPSU)\n  \n    ### Strata\n  dat2$strata <- as.factor(dat2$SDMVSTRA)\n  \n  ## Survey year\n  dat2$year <- dat2$SDDSRVYR\n  \n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n**NOTE:** The following code chunk recodes the variable, `SMD055`, which stands for the age cigarettes were last smoked regularly. This variable is not available for the cycle 2017-2018, thus it is set as `NA`. This part is essential for the plots in section [12.3 Appendix B: Exploratory Analysis of Smoking Duration](10-sensitivity-analysis.html#appendix-b-exploratory-analysis-of-smoking-duration) below.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/smoking.quit.age_c7d153652f495fffda0511c0ca34a20d'}\n\n```{.r .cell-code}\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  if (i < 10) {\n    ### Age smoking quit\n    dat2$smoking.quit.age <- dat2$SMD055\n    dat2$smoking.quit.age[dat2$smoking.quit.age == 777] <- NA\n    dat2$smoking.quit.age[dat2$smoking.quit.age == 999] <- NA\n  }\n  else {\n    dat2$smoking.quit.age <- NA\n  }\n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n---\n\n\n* R Code Chunk 2: Save New Files\n\nAfter the same remaining data processing steps are taken, theses 10 new files are also saved with the selected variables saved in `vars`.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/save_18716d7e0dc338f9ca891ea54719d986'}\n\n```{.r .cell-code}\nnhanes_all <- c(\"nhanes00\", \"nhanes01\", \"nhanes03\", \"nhanes05\", \n                \"nhanes07\", \"nhanes09\", \"nhanes11\", \n                \"nhanes13\", \"nhanes15\", \"nhanes17\")\n\nvars <- c(\"id\", \"age\", \"sex\", \"race\", \"born\", \"pir\", \"HHedu\", \n          \"smoking.age\", \"smoking.quit.age\",\n          \"smoked.while.child\", \"smoking\",\n          \"survey.weight\", \"psu\", \"strata\", \"year\")\n\n\ncycle_years <- c(\"1999-2000\", \"2001-2002\", \"2003-2004\", \"2005-2006\", \"2007-2008\", \n                 \"2009-2010\", \"2011-2012\", \"2013-2014\", \"2015-2016\", \"2017-2018\")\n\nfor (i in seq_along(data_all2)) {\n  dat2 <- data_all2[[i]]\n  \n  nhanes_i <- nhanes_all[i]\n  assign(nhanes_i, dat2[, vars], envir = .GlobalEnv)\n  \n  analytic <- subset(get(nhanes_i), age >= 20)\n  cat(\"Processing:\", nhanes_i, \"\\n\")\n  print(dim(analytic))\n  \n  analytic_i <- paste0(\"analytic\", substr(nhanes_i, 7, 8))\n  assign(analytic_i, analytic, envir = .GlobalEnv)\n  \n  # Create 'data2' directory if it does not exist\n  if (!dir.exists(\"data2\")) {\n    dir.create(\"data2\")\n  }\n\n  # Save\n  save(list = c(nhanes_i, analytic_i),\n       file = file.path(\"data2\", paste0(analytic_i, \".RData\")))\n}\n\n# Bind all\ndat.full <- rbind(nhanes00, nhanes01, nhanes03,\n                  nhanes05, nhanes07, nhanes09,\n                  nhanes11, nhanes13, nhanes15, \n                  nhanes17)\n\n# Corrected weights\ndat.full$survey.weight.new <- dat.full$survey.weight/length(unique(dat.full$year))\ndat.full$survey.weight <- NULL\nnames(dat.full)\ndim(dat.full)\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/loadMort_bc1051d08f15450bc5d1f082e9fd480f'}\n\n```{.r .cell-code}\n# Mortality Data\nmort2000 <- readRDS(file = \"data/Mortalitydata/mort2000.RData\")\nmort2001 <- readRDS(file = \"data/Mortalitydata/mort2001.RData\")\nmort2003 <- readRDS(file = \"data/Mortalitydata/mort2003.RData\")\nmort2005 <- readRDS(file = \"data/Mortalitydata/mort2005.RData\")\nmort2007 <- readRDS(file = \"data/Mortalitydata/mort2007.RData\")\nmort2009 <- readRDS(file = \"data/Mortalitydata/mort2009.RData\")\nmort2011 <- readRDS(file = \"data/Mortalitydata/mort2011.RData\")\nmort2013 <- readRDS(file = \"data/Mortalitydata/mort2013.RData\")\nmort2015 <- readRDS(file = \"data/Mortalitydata/mort2015.RData\")\nmort2017 <- readRDS(file = \"data/Mortalitydata/mort2017.RData\")\n\n# Merge\ndat.mortality <- rbind(mort2000, mort2001, mort2003,\n                       mort2005, mort2007, mort2009, \n                       mort2011, mort2013, mort2015, \n                       mort2017)\ntable(dat.mortality$mort_eligstat, useNA = \"always\")\n\n# Merging analytic and mortality data\ndat.full.with.mortality <- merge(dat.full, dat.mortality, by = \"id\", all.x = TRUE)\ndim(dat.full.with.mortality)\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recoding_e9d512ad3882a3e58b72ae38fbf9a618'}\n\n```{.r .cell-code}\n# Recoding\ndat.full.with.mortality$exposure.cat <- car::recode(dat.full.with.mortality$smoking.age, \" \n                                                    c(0,99) = 'Never smoked'; \n                                                    1:9 = 'Started before 10';\n                                                    10:14 = 'Started at 10-14';\n                                                    15:17 = 'Started at 15-17';\n                                                    18:20 = 'Started at 18-20';\n                                                    21:80 = 'Started after 20';\n                                                    else = NA \", \n                                                    as.factor = TRUE)\ndat.full.with.mortality$exposure.cat <- factor(dat.full.with.mortality$exposure.cat, \n                                               levels = c(\"Never smoked\",\n                                                          'Started before 10',\n                                                          'Started at 10-14',\n                                                          \"Started at 15-17\",\n                                                          \"Started at 18-20\",\n                                                          \"Started after 20\"))\n\n# Survival time - Person-Months of Follow-up from NHANES Interview date\n# changed to \"Number of Person Months of Follow-up from NHANES Mobile Examination Center (MEC) date\" from \"Number of Person Months of Follow-up from NHANES interview date\" as we are using MCQ data (not really changed it again!)\ndat.full.with.mortality$stime.since.interview <- dat.full.with.mortality$mort_permth_int # mort_permth_exm \nsummary(dat.full.with.mortality$stime.since.interview) \n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>     0.0    59.0   113.0   117.9   172.0   250.0   42252\n\n# Age in month\ndat.full.with.mortality$age.month <- dat.full.with.mortality$age * 12\nsummary(dat.full.with.mortality$age.month)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>     0.0   120.0   288.0   373.5   624.0  1020.0\n\n# Survival time - Person-Months of Follow-up from birth = birth to screening + screening to event/censor\ndat.full.with.mortality$stime.since.birth <- with(dat.full.with.mortality, age.month + stime.since.interview)\n# converted back to year so that KM plot is in years / HR results remain the same (added)\ndat.full.with.mortality$stime.since.birth <- dat.full.with.mortality$stime.since.birth/12\ndat.full.with.mortality$stime.since.birth[is.na(dat.full.with.mortality$stime.since.interview)] <- NA\nsummary(dat.full.with.mortality$stime.since.birth)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>   19.08   41.50   57.17   57.56   72.92  105.67   42252\n\n# All-cause mortality status\ndat.full.with.mortality$status_all <- dat.full.with.mortality$mort_stat\ntable(dat.full.with.mortality$status_all, useNA = \"always\")\n#> \n#>     0     1  <NA> \n#> 49815  9249 42252\n\n# Cause-specific mortality\ndat.full.with.mortality$mort_diabetes <- NULL\ndat.full.with.mortality$mort_hyperten <- NULL\ndat.full.with.mortality$mort_permth_int <- NULL\ndat.full.with.mortality$mort_permth_exm <- NULL\ndat.full.with.mortality$mort_ucod_leading <- NULL\ndat.full.with.mortality$mort_eligstat <- NULL\n\n# Recode year variable\ndat.full.with.mortality$year.cat <- dat.full.with.mortality$year\n\nnew_levels <- c(\n  \"1999-2000\", \"2001-2002\", \"2003-2004\", \"2005-2006\", \"2007-2008\",\n  \"2009-2010\", \"2011-2012\", \"2013-2014\", \"2015-2016\", \"2017-2018\"\n)\nlevels(dat.full.with.mortality$year.cat) <- new_levels\n\n# Display the unique levels of year.cat\nlevels(dat.full.with.mortality$year.cat)\n#>  [1] \"1999-2000\" \"2001-2002\" \"2003-2004\" \"2005-2006\" \"2007-2008\" \"2009-2010\"\n#>  [7] \"2011-2012\" \"2013-2014\" \"2015-2016\" \"2017-2018\"\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/analyticSubset_ede7a810b5e98bc1123bdca236a909e5'}\n\n```{.r .cell-code}\n# Create the analytic subset\ndat.full.with.mortality$smoked.while.child <- NULL\n\n### Analytic dataset - age 20 - 79\ndat.analytic <- subset(dat.full.with.mortality, age>=20 & age < 80)\ndim(dat.full.with.mortality)\n#> [1] 101316     21\ndim(dat.analytic)\n#> [1] 50824    21\ndim(dat.full.with.mortality)[1] - dim(dat.analytic)[1] # added\n#> [1] 50492\n\n# Drop variables that are not being used \ndat.analytic$stime.since.interview <- NULL\ndat.analytic$born <- NULL\ndat.analytic$age <- NULL\ndat.analytic$age.month <- NULL\n\n### Create a copy of the data for the smoking duration analysis later in the chapter\ndat.analytic.duration.analysis <- dat.analytic\n\n# Drop quit related variables\ndat.analytic$smoking.quit.age <- NULL\n```\n:::\n\n\n\n---\n\n* R Code Chunk 3: PIR and HHedu\n\nThe following code gives a summary table of the two variables: poverty income ratio (PIR) and education level of the household head.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/summary_c19e6646e3d9a1390f579c1556e14db9'}\n\n```{.r .cell-code}\ntable(dat.analytic$pir, useNA = \"always\")\n#> \n#>    Below Poverty Line     Near Poverty Line  Low to Middle Income \n#>                  9720                 11890                 12281 \n#> Middle to High Income           High Income                  <NA> \n#>                  3808                  8378                  4747\ntable(dat.analytic$HHedu, useNA = \"always\")\n#> \n#>     Less than high school    High school or college College graduate or above \n#>                     13009                     21704                     11048 \n#>                      <NA> \n#>                      5063\n```\n:::\n\n\n\n---\n\n* R Code Chunk 4: Accounting for Missing Data\n\nBefore analysis, we must handle missing data. The following code perform a complete-case analysis by first removing participants with missing exposure (`exposure.cat`) or outcome (`stime.since.birth`) information. Then, any remaining missing values in the covariates are handled, and the number of participants dropped at each stage is calculated.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/handle-missing_a6bb4295b73291c9a1595845a974a640'}\n\n```{.r .cell-code}\n# Sequentially remove participants with missing exposure or outcome\ndat.analytic1 <- dat.analytic[complete.cases(dat.analytic$stime.since.birth),]\ndat.analytic2 <- dat.analytic1[complete.cases(dat.analytic1$exposure.cat),]\n\n# Create the final complete-case dataset by removing any other missing values\ndat.complete <- na.omit(dat.analytic2)\ndim(dat.complete)\n#> [1] 41671    16\n\n# Report on participants dropped\ncat(\"Participants dropped due to missing exposure or outcome:\", \n    nrow(dat.analytic) - nrow(dat.analytic2), \"\\n\")\n#> Participants dropped due to missing exposure or outcome: 275\ncat(\"Participants dropped due to missing covariates:\", \n    nrow(dat.analytic2) - nrow(dat.complete), \"\\n\")\n#> Participants dropped due to missing covariates: 8878\ncat(\"Total participants dropped:\",\n    nrow(dat.full.with.mortality) - nrow(dat.complete), \"\\n\")\n#> Total participants dropped: 59645\n\n# Overwrite dat.analytic2 to be the final complete dataset for analysis\ndat.analytic2 <- dat.complete\ndim(dat.analytic2)\n#> [1] 41671    16\n\n# Save\nsave(dat.full.with.mortality, dat.analytic2, file = \"data/SensAnalysis.RData\")\n```\n:::\n\n\n\n---\n\n* R Code Chunk 5: Descriptive Statistics\n\nThe following code creates a descriptive summary table of the final analytic sample using the `CreateTableOne` function. The table shows the distribution of the exposure, race, and sex, stratified by mortality status.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/table1_47021effd72e367640d32f3dcd9f9772'}\n\n```{.r .cell-code}\ntab1 <- CreateTableOne(vars = c(\"exposure.cat\", \"race\", \"sex\"), \n                       strata = \"status_all\", \n                       data = dat.analytic2, \n                       addOverall = TRUE, \n                       test = TRUE)\n\ntab1$CatTable\n#>                       Stratified by status_all\n#>                        Overall       0             1            p      test\n#>   n                    41671         36426         5245                    \n#>   exposure.cat (%)                                              <0.001     \n#>      Never smoked      23570 (56.6)  21576 (59.2)  1994 (38.0)             \n#>      Started before 10   280 ( 0.7)    201 ( 0.6)    79 ( 1.5)             \n#>      Started at 10-14   3203 ( 7.7)   2560 ( 7.0)   643 (12.3)             \n#>      Started at 15-17   5949 (14.3)   4924 (13.5)  1025 (19.5)             \n#>      Started at 18-20   5194 (12.5)   4338 (11.9)   856 (16.3)             \n#>      Started after 20   3475 ( 8.3)   2827 ( 7.8)   648 (12.4)             \n#>   race (%)                                                      <0.001     \n#>      White             18234 (43.8)  15462 (42.4)  2772 (52.9)             \n#>      Black              8826 (21.2)   7571 (20.8)  1255 (23.9)             \n#>      Hispanic          10760 (25.8)   9735 (26.7)  1025 (19.5)             \n#>      Others             3851 ( 9.2)   3658 (10.0)   193 ( 3.7)             \n#>   sex = Female (%)     21429 (51.4)  19235 (52.8)  2194 (41.8)  <0.001\n```\n:::\n\n\n\n---\n\n### Analysis with SES Adjustment\n\n* R Code Chunk 6: Specify the Survey Design\n\nOnce again, to ensure our results are representative, we must account for the complex sampling design of NHANES. The following code creates a survey design object using the `svydesign()` function, incorporating the survey weights, strata, and PSU variables\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/surveyDes_118a371ce0b9566f679b73a58525883a'}\n\n```{.r .cell-code}\n# Create a flag to identify participants in our final analytic sample\ndat.full.with.mortality$miss <- 1\ndat.full.with.mortality$miss[dat.full.with.mortality$id %in% dat.analytic2$id] <- 0\ntable(dat.full.with.mortality$miss)\n#> \n#>     0     1 \n#> 41671 59645\n\n# Create the survey design object\nw.design <- svydesign(ids = ~psu, strata = ~strata, \n                      weights = ~survey.weight.new, \n                      data = dat.full.with.mortality, nest = T)\n\n# Subset the design object to our analytic sample\nw.design0 <- subset(w.design, miss == 0 & survey.weight.new > 0)\ndim(w.design0)\n#> [1] 41671    22\n```\n:::\n\n\n\n---\n\n\n* R Code Chunk 7: Regression and Survival Analysis\n\nThe following section contains the code for core statistical models for the sensitivity analysis, including Kaplan-Meier curves and various Cox proportional hazards models.\n\n**Kaplan-Meier Survival Curve** \n\nThe following code generates a survey-weighted Kaplan-Meier survival curve to visualize the probability of survival over time, stratified by the age of smoking initiation.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/kmplottingSens_febc542c059cd736e0ad2219a13767aa'}\n\n```{.r .cell-code}\ndummy <- length(unique(as.factor(w.design0$variables$exposure.cat)))\nformulax0 <- as.formula(Surv(stime.since.birth, status_all) ~ exposure.cat)\nsA<-svykm(formulax0, design=w.design0)\n\n# Plot\npar(oma=rep(0,4))\npar(mar=c(5,4,0,0) + 0.1)\nplot(sA, pars=list(col=c(1:dummy)),\n     xlab = \"Time\",\n     ylab = \"Proportion surviving\")\nlegend(\"bottomleft\", levels(as.factor(w.design0$variables$exposure.cat)),\n       col = (1:dummy), lty = c(1,1))\n```\n\n::: {.cell-output-display}\n![Sensitivity Analysis 1: Survey-Weighted Kaplan-Meier Curves](images/sub/kmplottingSens-1.png){fig-pos='H'}\n:::\n:::\n\n\n\n<br>\n\n**Log-Rank Test**\n\nThe following code performs a weighted log-rank test to see if the differences between the curves are statistically significant.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/logrank_ca8827c1cabfb8c7499b0e52dcb460c4'}\n\n```{.r .cell-code}\n# Weighted logrank test\nlrt <- svylogrank(formulax0,design=subset(w.design0, survey.weight.new>0))\nround(lrt[[2]],2)\n#>  Chisq      p \n#> 271.25   0.00\n```\n:::\n\n\n\n<br>\n\n**Cox Proportional Hazards Models** \n\nThe following code fits several survey-weighted Cox models to estimate the Hazard Ratios (HRs) for all-cause mortality associated with smoking initiation age. We fit:\n\n-   \n\n    1.  An unadjusted (crude) model.\n\n-   \n\n    2.  An adjusted model, controlling for sex, race, survey year, and the SES proxy variables (pir and HHedu).\n\n-   \n\n    3.  Two effect modification models to see if the association is different across racial/ethnic groups and by sex.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/coxModels_45c12f38b4abd3c9f98c8b2b74f32baa'}\n\n```{.r .cell-code}\n# Test One\nfit0_ <- coxph(Surv(stime.since.birth, status_all) ~ exposure.cat, data = dat.complete)\nfit0_\n\n\n# Unadjusted model\nfit0 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat, \n                 design = w.design0)\nfit0\n\n# Adjusted model overall with SES proxies as covariates\nfit1 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat + sex + race + year.cat + pir + HHedu,\n                 design = w.design0)\nfit1\n\n# Effect modification by race model + proxies\nfit2 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat*race\n                 + sex  + year.cat + pir +HHedu,\n                 design = w.design0)\nfit2\n\n# Effect modification by sex model + proxies\nfit3 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat*sex \n                 + race + year.cat + pir + HHedu,\n                 design = w.design0)\nfit3\n```\n:::\n\n\n\n---\n\n* R Code Chunk 8: Prepare Data for Forest Plot\n\nThe following code extracts the Hazard Ratios and 95% Confidence Intervals from each of the four models above: `fit0`, `fit1`, `fit2`, and `fit3`. It then combines them into a single data frame (`fr`) that will be used to create a summary forest plot.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/modelResults_c64eb11fea820a610164c00f10680da2'}\n\n```{.r .cell-code}\n# Extract results from crude model (fit0)\nf0 <- publish(fit0)\nf0r <- f0$regressionTable[2:6,c(\"HazardRatio\",\"CI.95\")]\nf0r$group <- \"Crude\"\n\n# Extract results from adjusted model (fit1)\nf1 <- publish(fit1)\nf1r <- f1$regressionTable[2:6,c(\"HazardRatio\",\"CI.95\")]\nf1r$group <- \"Adjusted\"\n\n# Extract results from race interaction model (fit2)\nf2 <- publish(fit2)\nf2rW <- f2$regressionTable[(31:35)+8,c(\"HazardRatio\",\"CI.95\")]\nf2rB <- f2$regressionTable[(36:40)+8,c(\"HazardRatio\",\"CI.95\")]\nf2rH <- f2$regressionTable[(41:45)+8,c(\"HazardRatio\",\"CI.95\")]\nf2rW$group <- \"White\"\nf2rB$group <- \"Black\"\nf2rH$group <- \"Hispanic\"\nf2r <- rbind(f2rW, f2rB, f2rH)\n\n# Extract results from sex interaction model (fit3)\nf3 <- publish(fit3)\nf3rM <- f3$regressionTable[29:33,c(\"HazardRatio\",\"CI.95\")]\nf3rF <- f3$regressionTable[34:38,c(\"HazardRatio\",\"CI.95\")]\nf3rM$group <- \"Male\"\nf3rF$group <- \"Female\"\nf3r <- rbind(f3rM, f3rF)\n\n# Combine all results into one data frame\nfr <- rbind(f0r,f1r,f2r,f3r)\nfr <- as.data.frame(fr)\nfr$age.grp <- c('Started before 10', 'Started at 10-14', \"Started at 15-17\",\n                \"Started at 18-20\", \"Started after 20\")\n\n# Clean up numeric columns\nci <- stringr::str_extract_all(fr$CI.95, '\\\\d+([.,]\\\\d+)?', simplify = TRUE)\nfr$mean <- as.numeric(fr$HazardRatio)\nfr$lower <- as.numeric(as.character(ci[,1]))\nfr$upper <- as.numeric(as.character(ci[,2]))\n#fr$CI.95 <- NULL\nfr$HazardRatio <- NULL\n\n# Save the plot data\nfrS <- fr\nsave(frS, file = \"data/SensForest.RData\")\n```\n:::\n\n\n\n---\n\n### Visualizing the SES-Adjusted Results \n\n* R Code Chunk 9: Plot\n\nThe following code creates the forest plot using `ggplot2`. The first plot summarizes all the results from this sensitivity analysis. This plot corresponds to _Appendix Figure 5_ in section C.2 Sensitivity analysis with proxy covariates, part of the supplementary materials published with the paper.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/forestplotting_e841488a4d97c3c2c9e5a5f923aa24cd'}\n\n```{.r .cell-code}\nfr$age.grp <- factor(fr$age.grp,\n                     levels = c('Started before 10', 'Started at 10-14',\n                                \"Started at 15-17\", \"Started at 18-20\",\n                                \"Started after 20\"))\nfr$group <- factor(fr$group,\n                   levels = rev(c(\"Crude\", \"Adjusted\", \n                                  \"White\", \"Black\", \"Hispanic\", \n                                  \"Male\", \"Female\")))\nlevels(fr$group)[levels(fr$group) == \"White\"] <- \"Non-Hispanic White\"\nlevels(fr$group)[levels(fr$group) == \"Black\"] <- \"Non-Hispanic Black\"\nfr$text_label <- sprintf(\"%.2f [%.2f;%.2f]\", fr$mean, fr$lower, fr$upper)\n\n# Plotting\nggplot(fr, aes(x = mean, y = group, colour = age.grp)) + \n  geom_errorbar(aes(xmin = lower, xmax = upper), position = position_dodge(0.9), width = 0.25) +\n  geom_point(position = position_dodge(0.9), shape = 1) +\n  geom_text(aes(label = text_label, x = upper, hjust = -0.05), position = position_dodge(0.9)) +\n  scale_x_continuous(limits = c(0, 7.7)) +\n  labs(x = \"Hazard Ratio\", y = \"\", legend=TRUE, col = \"Age group\") +\n  theme_classic() +\n  theme(panel.grid.major.x = element_blank(),\n        panel.border = element_blank(),\n        legend.title = element_text(size=12), \n        legend.text = element_text(size=12),\n        plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(size = 10, face = \"bold\"),\n        axis.text.y = element_text(size = 10, face = \"bold\"),\n        legend.position = c(.8, .8))+\n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"grey\")+\n  guides(color = guide_legend(override.aes = list(shape = 1, linetype = 1, size = 1)))\n```\n\n::: {.cell-output-display}\n![Appendix Figure 5: Forest plot of Hazard Ratios from the SES-adjusted sensitivity analysis.](images/sub/forestplotting-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# Save Plot\n#ggsave(\"images/forestSens.png\", width = 10, height = 8)\n```\n:::\n\n\n\n<br>\n\nThis second plot creates a direct visual comparison between the main analysis results and this sensitivity analysis.\n\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/plot2_cf55810a711acb4fe98eac5a59b99955'}\n\n```{.r .cell-code}\n# Load the data for both plots\nload(file=\"data/SensForest.RData\")\nload(file=\"data/MainForest.RData\")\n\n# Combine data from fr (main) and frS (sensitivity), with an indicator variable\ncombined_data <- bind_rows(\n  mutate(fr, dataset = 'Main Analysis'),\n  mutate(frS, dataset = 'Sensitivity Analysis')\n)\ncombined_data$group <- factor(combined_data$group, levels = unique(combined_data$group))\n\n# Create the plot\nggplot(combined_data, aes(x = mean, y = group, colour = age.grp, shape = dataset)) +\n  geom_errorbar(aes(xmin = lower, xmax = upper), position = position_dodge(width = 0.7)) +\n  geom_point(position = position_dodge(width = 0.7), size = 2) +\n  scale_x_continuous(limits = c(0, 7)) +\n  labs(x = \"Hazard Ratio\", y = \"\", colour = \"Age group\", shape = \"Analysis Type\") +\n  theme_classic() +\n  theme(axis.text.x = element_text(size = 10, face = \"bold\"),\n        axis.text.y = element_text(size = 10),\n        legend.position = \"right\") +\n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"grey\")\n```\n\n::: {.cell-output-display}\n![Comparison of results: Main vs. SES-adjusted Sensitivity Analysis.](images/sub/plot2-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\n# Save Plot\n#ggsave(\"images/combined_forest_plot.png\", width = 10, height = 6)\n```\n:::\n\n\n\n\n\n<hr style=\"border: none; border-top: 3px solid black; width: 100%; margin-top: 1em; margin-bottom: 1em;\">\n\n\n## Sensitivity Analysis 2: Effect Modification by Race/Ethnicity (2011-2018)\n\n### Data Reprocessing for the 2011-2018 Sub-period\n\nThe paper also notes that starting from the 2011−2012 cycle, NHANES introduced a new category labeled non-Hispanic Asian. To investigate the implications of this change, an additional analysis of effect modification by race/ethnicity was conducted specifically for the survey cycles spanning 2011-2018. The following sections re-run similar data merging and cleaning steps, and the different models as in the main analysis code sections, thus only the important changes are noted.\n\n---\n\n* R Code Chunk 1: Redo Data Preparation\n\nThe following code shows the respective data needed from the `nhanesA` library for the 4 cycles and the steps to prepare the specific dataset required for the 2011-2018 sub-period sensitivity analysis. This again, involves downloading raw data, merging them, and constructing necessary variables, mirroring the steps in the main data preparation but for this specific sub-period. The analysis focuses on the 4 cycles spanning 2011-2018.\n\nThe same steps are taken, thus only important changes are noted below.\n\n-   Load Analytic Data for 2011-2018 Cycles and Merge\n-   Load and Merge Mortality Data for Sub-period Analysis\n-   Variable Construction for Sub-period Data\n-   Construct Final Analytic Dataset for Sub-period Analysis\n-   Create Survey Design Object for Sub-period Analysis\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/reload_8a384dd4c3889121e463c9b12b1df331'}\n\n```{.r .cell-code}\n# 2011-2012, 2013-2014, 2015-2016, 2017-2018\ndemo <- c(\"DEMO_G\", \"DEMO_H\", \"DEMO_I\", \"DEMO_J\")\nsmoking <- c(\"SMQ_G\", \"SMQ_H\", \"SMQ_I\", \"SMQ_J\")\n\n# DEMOGRAPHICS\ndemo_list_2 <- lapply(demo, nhanes)\ndemo_data_files <- demo_list_2\n\n# SMOKING\nsmoking_list_2 <- lapply(smoking, nhanes)\nsmoking_data_files <- smoking_list_2\n```\n:::\n\n\n\nThe following variables are selected from the data for 4 cycles spanning 2011-2018. The variable `RIDRETH3` includes the Race/Hispanic origin w/ NH Asian group. The remaining variables selected are the same as in the main analysis.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/variables _4931390db343fa87cbd14d9bf6d59cee'}\n\n```{.r .cell-code}\ndemo_columns_2 <- c(\"SEQN\", \"RIDAGEYR\", \"RIAGENDR\",\n                    \"RIDRETH1\", \"RIDRETH3\", \"DMDBORN4\", \n                    \"SDDSRVYR\", \"WTINT2YR\", \"WTMEC2YR\", \n                    \"SDMVPSU\", \"SDMVSTRA\") \n\nsmoking_columns_2 <- c(\"SEQN\", \"SMQ020\", \"SMD030\", \"SMQ040\") \n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/subset_8ca6432595332ad94e9670a7ee7550fd'}\n\n```{.r .cell-code}\n# DEMOGRAPHICS\ndemo_data_files_2 <- lapply(seq_along(demo_data_files), function(i) \n  {\n  current_cycle_data <- demo_data_files[[i]]\n  original <- demo[i] \n  \n  # Select Columns\n  subset_data <- current_cycle_data %>% \n    dplyr::select(dplyr::any_of(demo_columns_2))\n  # Translate \n  translated_data <- nhanesTranslate(original,\n                                     names(subset_data), \n                                     data = subset_data)\n  # Return\n  return(translated_data) \n})\n\n\n# SMOKING\nsmoking_data_files_2 <- lapply(seq_along(smoking_data_files), function(i) \n  {\n  current_cycle_data <- smoking_data_files[[i]]\n  original <- smoking[i]\n\n  # Select Columns\n  subset_data <- current_cycle_data %>%\n    dplyr::select(dplyr::any_of(smoking_columns_2))\n  # Translate\n  translated_data <- nhanesTranslate(original, \n                                     names(subset_data), \n                                     data = subset_data)\n  # Return\n  return(translated_data)\n})\n\n\n# Merge\ndata_all <- lapply(seq_along(demo_data_files_2), function(i) {\n  demo_df <- demo_data_files_2[[i]]\n  smoking_df <- smoking_data_files_2[[i]]\n  \n  # Merge by SEQN\n  merged_df <- join_all(list(demo_df, smoking_df), \n                        by = \"SEQN\", \n                        type = 'full')\n  return(merged_df)\n})\n```\n:::\n\n\n\n---\n\n* R Code Chunk 2: Recode\n\nThe following sections of code apply the same recoding except we have another race/ethnicity this time.\n\n*ID:*\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recoding1_09369f785f4f2d9ba375c629ab804d56'}\n\n```{.r .cell-code}\ndata_all2 <- data_all\n\n# ID\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  # ID\n  dat2$id <- dat2$SEQN\n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n*Demographic Variables:*\n\n-   Below, the demographic variables like age, sex, and importantly, both race (from RIDRETH1) and race2 (from RIDRETH3 to include Asian) are recoded for the sub-period data.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recoding2_2efbdbe81b70f45f5f47ca9d10d09de2'}\n\n```{.r .cell-code}\n# Demo\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  # Age\n  dat2$age <- dat2$RIDAGEYR\n  \n  # Sex\n  dat2$sex <- dat2$RIAGENDR\n  \n  # Race/Ethnicity (RIDRETH1 and RIDRETH3)\n  dat2$race <- dat2$RIDRETH1\n  dat2$race <- car::recode(dat2$race, recodes = \"\n    'Non-Hispanic White'='White';\n    'Non-Hispanic Black'='Black';\n    c('Mexican American','Other Hispanic')='Hispanic';\n    else='Others'\")\n  dat2$race <- factor(dat2$race, \n                      levels = c(\"White\", \"Black\", \"Hispanic\", \"Others\"))\n  \n  \n  dat2$race2 <- dat2$RIDRETH3\n  dat2$race2 <- car::recode(dat2$race2, recodes = \" \n            'Non-Hispanic White'='White';\n            'Non-Hispanic Black'='Black'; \n            'Non-Hispanic Asian'='Asian';\n            c('Mexican American','Other Hispanic')= 'Hispanic'; \n            else='Others' \")  \n  dat2$race2 <- factor(dat2$race2, levels = c(\"White\", \"Black\",\n                                              \"Hispanic\", \"Asian\",\n                                              \"Others\"))\n  \n  \n  \n  # Country of birth / citizenship\n  dat2$born <- dat2$DMDBORN4\n  dat2$born <- car::recode(dat2$born, recodes = \" \n  'Others'='Other place';\n  'Born in 50 US states or Washington, DC'= 'Born in US'; \n  else=NA\")\n  dat2$born <- factor(dat2$born, \n                      levels = c(\"Born in US\", \"Other place\"))\n  \n  data_all2[[i]] <- dat2\n  }\n```\n:::\n\n\n\n*Smoking:*\n\n-   Below, the smoking-related variables, including smoking status, age started smoking and whether smoking started at age 15 or younger for the sub-period data are recoded.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recoding3_a3e3d3a4c3b13ff9b79e947ac58e1328'}\n\n```{.r .cell-code}\n# Smoking\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  # Smoking Status\n  dat2$smoking <- dat2$SMQ020\n  dat2$smoking <- car::recode(dat2$smoking, \"\n    'Yes' = 'Current smoker';\n    'No' = 'Never smoker';\n    else = NA\")\n  dat2$smoking <- factor(dat2$smoking, \n                         levels = c(\"Never smoker\", \n                                    \"Previous smoker\", \n                                    \"Current smoker\"))\n  \n  # Ask about variable SMQ040 ***\n  dat2$smoking[dat2$SMQ040 == \"Not at all?\" | \n                 dat2$SMQ040 == \"Not at all\"] <- \"Previous smoker\"\n  \n  # Age Started Smoking\n  dat2$smoking.age <- dat2$SMD030\n  dat2$smoking.age[dat2$smoking.age %in% c(777, 999)] <- NA\n  dat2$smoking.age[is.na(dat2$smoking.age) & \n                     dat2$smoking == \"Never smoker\"] <- 0\n  \n  # Whether Smoking started age ≤ 15\n  dat2$smoked.while.child <- car::recode(dat2$smoking.age, \n  \" 0 = 'No'; 6:15 = 'Yes'; else = NA \", as.factor = TRUE)\n  \n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n*Survey Design:*\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recoding4_ddf8319255d4e7b2ce1551c52e6c0cbc'}\n\n```{.r .cell-code}\n# Survey Design\nfor (i in seq_along(data_all2)) {\n  # Set Data\n  dat2 <- data_all2[[i]]\n  \n  # Weight\n  dat2$survey.weight <- dat2$WTINT2YR\n  \n  # PSU\n  dat2$psu <- as.factor(dat2$SDMVPSU)\n  \n  # Strata\n  dat2$strata <- as.factor(dat2$SDMVSTRA)\n  \n  # Survey year\n  dat2$year <- dat2$SDDSRVYR\n  \n  data_all2[[i]] <- dat2\n}\n```\n:::\n\n\n\n---\n\n* R Code Chunk 3: Save Analytic Data for Sub-period Analysis (Per Cycle)\n\nThe following code processes the cleaned sub-period dataframes, applies the age filter (\\>20 years), selects the final set of variables, and saves them as .RData files for each cycle.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/analytic-data_56f4ca5e0e38a2037106c91783250c70'}\n\n```{.r .cell-code}\n\nnhanes2_all <- c(\"nhanes2_11\", \"nhanes2_13\", \"nhanes2_15\", \"nhanes2_17\")\nvars_2 <- c(\"id\", \"age\", \"sex\", \"race\", \"race2\", \"born\", \n          \"smoking.age\", \"smoked.while.child\", \"smoking\", \n          \"survey.weight\", \"psu\", \"strata\", \"year\")\n\nfor (i in seq_along(data_all2)) {\n  dat2 <- data_all2[[i]]\n\n  nhanes2_i <- nhanes2_all[i]\n  assign(nhanes2_i, dat2[, vars_2], envir = .GlobalEnv)\n  \n  analytic <- subset(get(nhanes2_i), age >= 20)\n  cat(\"Processing:\", nhanes2_i, \"\\n\")\n  print(dim(analytic))\n  \n  analytic_i <- paste0(\"analytic2_\", substr(nhanes2_i, 9, 10))\n  analytic_i\n  assign(analytic_i, analytic, envir = .GlobalEnv)\n  \n  # Create 'data' directory if it does not exist\n  if (!dir.exists(\"data\")) {\n    dir.create(\"data\")\n  }\n  # Save\n  save(list = c(nhanes2_i, analytic_i),\n       file = file.path(\"data\", paste0(analytic_i, \".RData\")))\n  #print(analytic_i)\n}\n#> Processing: nhanes2_11 \n#> [1] 5560   13\n#> Processing: nhanes2_13 \n#> [1] 5769   13\n#> Processing: nhanes2_15 \n#> [1] 5719   13\n#> Processing: nhanes2_17 \n#> [1] 5569   13\n```\n:::\n\n\n\n---\n\n* R Code Chunk 4: Combine analytic files\n\nThe following code ensure the individual analytic .RData files for the sub-period are loaded and combines them into a single `dat.full.2` dataframe, recalculating weights for the combined period.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/load-4_00022ac6084d94a8fd91ed0a1631fe88'}\n\n```{.r .cell-code}\n# Load the 4 new datasets\nload(file=\"data/analytic2_11.RData\")\nload(file=\"data/analytic2_13.RData\")\nload(file=\"data/analytic2_15.RData\")\nload(file=\"data/analytic2_17.RData\")\n\n# Bind\ndat.full.2 <- rbind(nhanes2_11, nhanes2_13, nhanes2_15, nhanes2_17)\n\n# Confirm\nunique(dat.full.2$year)\n#> [1] NHANES 2011-2012 public release NHANES 2013-2014 public release\n#> [3] NHANES 2015-2016 public release NHANES 2017-2018 public release\n#> 4 Levels: NHANES 2011-2012 public release ... NHANES 2017-2018 public release\nlength(unique(dat.full.2$year))\n#> [1] 4\n\n# Corrected weights\ndat.full.2$survey.weight.new <- dat.full.2$survey.weight/length(unique(dat.full.2$year))\ndat.full.2$survey.weight <- NULL\nnames(dat.full.2)\n#>  [1] \"id\"                 \"age\"                \"sex\"               \n#>  [4] \"race\"               \"race2\"              \"born\"              \n#>  [7] \"smoking.age\"        \"smoked.while.child\" \"smoking\"           \n#> [10] \"psu\"                \"strata\"             \"year\"              \n#> [13] \"survey.weight.new\"\ndim(dat.full.2)\n#> [1] 39156    13\n```\n:::\n\n\n\n---\n\n* R Code Chunk 5: Load and Merge Mortality Data for Sub-period Analysis\n\nThe following code loads the individual mortality datasets for the 4 cycles and combines them. Subsequently, it merges this comprehensive mortality data with the full sub-period analytic dataset (`dat.full.2`) using the `id` variable.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/mortData_ce471158658a6729fb00f09539256504'}\n\n```{.r .cell-code}\nmort2000 <- readRDS(file = \"data/Mortalitydata/mort2000.RData\")\nmort2001 <- readRDS(file = \"data/Mortalitydata/mort2001.RData\")\nmort2003 <- readRDS(file = \"data/Mortalitydata/mort2003.RData\")\nmort2005 <- readRDS(file = \"data/Mortalitydata/mort2005.RData\")\nmort2007 <- readRDS(file = \"data/Mortalitydata/mort2007.RData\")\nmort2009 <- readRDS(file = \"data/Mortalitydata/mort2009.RData\")\nmort2011 <- readRDS(file = \"data/Mortalitydata/mort2011.RData\")\nmort2013 <- readRDS(file = \"data/Mortalitydata/mort2013.RData\")\nmort2015 <- readRDS(file = \"data/Mortalitydata/mort2015.RData\")\nmort2017 <- readRDS(file = \"data/Mortalitydata/mort2017.RData\")\n\ndat.mortality.2 <- rbind(mort2000, mort2001, mort2003,\n                       mort2005, mort2007, mort2009, \n                       mort2011, mort2013, mort2015, \n                       mort2017)\n\ndat.full.with.mortality.2 <- merge(dat.full.2, dat.mortality.2, \n                                   by = \"id\", all.x = TRUE)\ndim(dat.full.with.mortality.2)\n#> [1] 39156    20\n```\n:::\n\n\n\nThe following code applies recoding which is also similar to main analysis.\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/recode_0984c8b877c0fbf0e833e0241207d815'}\n\n```{.r .cell-code}\ndat.full.with.mortality.2$exposure.cat <- car::recode(dat.full.with.mortality.2$smoking.age, \" \n                                                    0 = 'Never smoked'; \n                                                    1:9 = 'Started before 10';\n                                                    10:14 = 'Started at 10-14';\n                                                    15:17 = 'Started at 15-17';\n                                                    18:20 = 'Started at 18-20';\n                                                    21:80 = 'Started after 20';\n                                                    else = NA \", \n                                                    as.factor = TRUE)\ndat.full.with.mortality.2$exposure.cat <- factor(dat.full.with.mortality.2$exposure.cat, \n                                               levels = c(\"Never smoked\",\n                                                          'Started before 10',\n                                                          'Started at 10-14',\n                                                          \"Started at 15-17\",\n                                                          \"Started at 18-20\",\n                                                          \"Started after 20\"))\n\n\n# Survival time - Person-Months of Follow-up from NHANES Interview date\n# changed to \"Number of Person Months of Follow-up from NHANES Mobile Examination Center (MEC) date\" from \"Number of Person Months of Follow-up from NHANES interview date\" as we are using MCQ data\ndat.full.with.mortality.2$stime.since.interview <- dat.full.with.mortality.2$mort_permth_int # mort_permth_exm \nsummary(dat.full.with.mortality.2$stime.since.interview) \n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>    1.00   34.00   58.00   58.67   82.00  113.00   15424\n\n# Age in month\ndat.full.with.mortality.2$age.month <- dat.full.with.mortality.2$age * 12\nsummary(dat.full.with.mortality.2$age.month)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#>     0.0   120.0   336.0   386.9   648.0   960.0\n\n# Survival time - Person-Months of Follow-up from birth = birth to screening + screening to event/censor\ndat.full.with.mortality.2$stime.since.birth <- with(dat.full.with.mortality.2, age.month + stime.since.interview)\n# converted back to year so that KM plot is in years / HR results remain the same (added)\ndat.full.with.mortality.2$stime.since.birth <- dat.full.with.mortality.2$stime.since.birth/12\ndat.full.with.mortality.2$stime.since.birth[is.na(dat.full.with.mortality.2$stime.since.interview)] <- NA\nsummary(dat.full.with.mortality.2$stime.since.birth)\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>   19.08   37.17   53.17   53.08   68.17   89.00   15424\n\n# All-cause mortality status\ndat.full.with.mortality.2$status_all <- dat.full.with.mortality.2$mort_stat\ntable(dat.full.with.mortality.2$status_all, useNA = \"always\")\n#> \n#>     0     1  <NA> \n#> 22216  1516 15424\n\n# Cause-specific mortality\ndat.full.with.mortality.2$mort_diabetes <- NULL\ndat.full.with.mortality.2$mort_hyperten <- NULL\ndat.full.with.mortality.2$mort_permth_int <- NULL\ndat.full.with.mortality.2$mort_permth_exm <- NULL\ndat.full.with.mortality.2$mort_ucod_leading <- NULL\ndat.full.with.mortality.2$mort_eligstat <- NULL\n```\n:::\n\n\n\n---\n\n* R Code Chunk 6: Variable Construction and Final Analytic Dataset for Sub-period Analysis\n\nThe same variables are constructed as the main analysis, but note, only for the 4 cycles. Below, the year variable is recoded into categorical levels. Then, the final data set is saved.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/year-Recode_ba5cfc0d06086bd0274495315c2b54e6'}\n\n```{.r .cell-code}\n# Recode year variable\ndat.full.with.mortality.2$year.cat <- dat.full.with.mortality.2$year\n\nnew_levels <- c(\"2011-2012\", \"2013-2014\", \"2015-2016\", \"2017-2018\")\nlevels(dat.full.with.mortality.2$year.cat) <- new_levels\n\n# Display the unique levels of year.cat\nlevels(dat.full.with.mortality.2$year.cat)\n#> [1] \"2011-2012\" \"2013-2014\" \"2015-2016\" \"2017-2018\"\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/data-cleaning_c63478150d1ac19908bda78ecbc2e515'}\n\n```{.r .cell-code}\n# Remove variable, not used\ndat.full.with.mortality.2$smoked.while.child <- NULL\n\n### Analytic dataset - age 20 - 79\ndat.analytic.2 <- subset(dat.full.with.mortality.2, age>=20 & age < 80)\ndim(dat.full.with.mortality.2)[1] - dim(dat.analytic.2)[1] # added\n#> [1] 18057\n\n# Drop variables that are not being used \ndat.analytic.2$born <- NULL\ndat.analytic.2$age <- NULL\ndat.analytic.2$age.month <- NULL\n\n# No missing exposure or outcome\ndim(dat.analytic.2)\n#> [1] 21099    16\ndat.analytic1 <- dat.analytic.2[complete.cases(dat.analytic.2$stime.since.birth),]\ndim(dat.analytic1)\n#> [1] 21011    16\ndat.analytic2 <- dat.analytic1[complete.cases(dat.analytic1$exposure.cat),]\ndim(dat.analytic2)\n#> [1] 20950    16\nprofile_missing(dat.analytic2)\n#>                  feature num_missing pct_missing\n#> 1                     id           0           0\n#> 2                    sex           0           0\n#> 3                   race           0           0\n#> 4                  race2           0           0\n#> 5            smoking.age           0           0\n#> 6                smoking           0           0\n#> 7                    psu           0           0\n#> 8                 strata           0           0\n#> 9                   year           0           0\n#> 10     survey.weight.new           0           0\n#> 11             mort_stat           0           0\n#> 12          exposure.cat           0           0\n#> 13 stime.since.interview           0           0\n#> 14     stime.since.birth           0           0\n#> 15            status_all           0           0\n#> 16              year.cat           0           0\n\n# No missing values in covariates - complete case dataset \ndat.complete.2 <- na.omit(dat.analytic2)\ndim(dat.complete.2)\n#> [1] 20950    16\n\n# Participants dropped - overall\nnrow(dat.full.with.mortality.2) - nrow(dat.complete.2)\n#> [1] 18206\n\n# Participants dropped - due to missing exposure or outcome\nnrow(dat.analytic.2) - nrow(dat.analytic2)\n#> [1] 149\n\n# Participants dropped - due to missing covariates\nnrow(dat.analytic2) - nrow(dat.complete.2)\n#> [1] 0\n\n# added\ntable(dat.analytic.2$exposure.cat, useNA = \"always\")\n#> \n#>      Never smoked Started before 10  Started at 10-14  Started at 15-17 \n#>             12437               126              1497              2769 \n#>  Started at 18-20  Started after 20              <NA> \n#>              2440              1767                63\n```\n:::\n\n\n\nSave the final analytic data for sensitivity analysis used below.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/saveSubAsian_640853af49aef623497318f529f4513d'}\n\n```{.r .cell-code}\nsave(dat.complete.2, file = \"data/dat.complete.2.RData\")\n```\n:::\n\n\n\n---\n\n### Analysis of the 2011-2018 Sub-period\n\n* R Code Chunk 7: Analysis\n\nThe following code sets up the survey design object (`w.design.2.0`) specifically for the 2011-2018 sub-period. It uses the `psu`, `strata`, and `survey.weight.new` variables to correctly account for the complex sampling methodology within this subset of the data. This `w.design.2.0` object is essential for running survey-weighted models in this sensitivity analysis.\n\nThe following code sets up the survey design object for the 2011-2018 sub-period as in the main analysis.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/survey-design_8aff970543cac6080c97f6387f14b395'}\n\n```{.r .cell-code}\n# Set up the design \ndat.full.with.mortality.2$miss <- 1\ndat.full.with.mortality.2$miss[dat.full.with.mortality.2$id %in% dat.analytic2$id] <- 0\ntable(dat.full.with.mortality.2$miss)\n#> \n#>     0     1 \n#> 20950 18206\n\nw.design.2 <- svydesign(ids = ~psu, strata = ~strata, weights = ~survey.weight.new, \n                      data = dat.full.with.mortality.2, nest = TRUE)\n\n# Subset the design\nw.design.2.0 <- subset(w.design.2, miss == 0 & survey.weight.new > 0)\n```\n:::\n\n\n\n---\n\n* R Code Chunk 8: Descriptive Statistics for Sub-period (**Appendix Table 3**)\n\nThe following table reproduces _Appendix Table 3_ from the paper. It summarizes the demographic characteristics of the cohort from the 2011-2018 NHANES cycles, stratified by smoking initiation categories, to provide context for this sensitivity analysis.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/Table3_d721e4edcb9918eb90b680d816764385'}\n\n```{.r .cell-code}\n# Create the weighted table using the survey design object for the 2011-2018 data\ntab_app_3_weighted <- svyCreateTableOne(vars = c(\"race2\"),\n                                        strata = \"exposure.cat\",\n                                        data = w.design.2.0,\n                                        addOverall = TRUE,\n                                        test = TRUE)\n\n# Print and format the table\ntab_app_3_printed <- print(tab_app_3_weighted,\n                           format = \"p\",\n                           catDigits = 2,\n                           showAllLevels = TRUE,\n                           smd = TRUE)\n\n# Define the desired column order\nnew_order_t3 <- c(\"level\", \"Never smoked\", \"Started before 10\", \n                  \"Started at 10-14\", \"Started at 15-17\", \n                  \"Started at 18-20\", \"Started after 20\", \n                  \"Overall\", \"p\", \"test\", \"SMD\")\n\n# Apply the new order to the table object\ntab_app_3 <- tab_app_3_printed[, new_order_t3]\n```\n:::\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/displayT3_530f3105fe9f5956713223be15949b4f'}\n\n```{.r .cell-code}\n# Display the formatted table using kable for a clean Quarto output\nkable(tab_app_3, caption = \"Appendix Table 3: Characteristics \n      of the study sample for the 2011-2018 NHANES cycles,\n      stratified by smoking initiation age.\") %>% \n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n```\n\n::: {.cell-output-display}\n\\begin{longtable}[t]{llllllllllll}\n\\caption{\\label{tab:displayT3}Appendix Table 3: Characteristics \n      of the study sample for the 2011-2018 NHANES cycles,\n      stratified by smoking initiation age.}\\\\\n\\toprule\n & level & Never smoked & Started before 10 & Started at 10-14 & Started at 15-17 & Started at 18-20 & Started after 20 & Overall & p & test & SMD\\\\\n\\midrule\nn &  & 128386920.10 & 1240174.76 & 16008335.09 & 32086914.62 & 26126847.18 & 15892076.56 & 219741268.30 &  &  & \\\\\nrace2 (\\%) & White & 59.51 & 74.22 & 73.86 & 73.66 & 68.27 & 60.61 & 63.82 & <0.001 &  & 0.284\\\\\n & Black & 12.39 & 5.51 & 7.49 & 8.55 & 11.03 & 16.85 & 11.59 &  &  & \\\\\n & Hispanic & 17.72 & 11.12 & 12.94 & 11.46 & 12.77 & 12.87 & 15.48 &  &  & \\\\\n & Asian & 7.62 & 1.33 & 1.31 & 2.14 & 3.40 & 5.30 & 5.65 &  &  & \\\\\n\\addlinespace\n & Others & 2.76 & 7.82 & 4.40 & 4.19 & 4.53 & 4.36 & 3.45 &  &  & \\\\\n\\bottomrule\n\\end{longtable}\n:::\n:::\n\n\n\n---\n\n**Sub-Period Specific Analyses** This subsection presents the Kaplan-Meier curve, unadjusted and adjusted Cox models for the 2011-2018 sub-period data, providing initial insights before delving into effect modification.\n\n* R Code Chunk 9 : Kaplan-Meier Curves and Log-Rank Test for Sub-period\n\nThe following code visualizes the survival probabilities for the 2011-2018 sub-period data using Kaplan-Meier curves, stratified by `exposure.cat`. It also performs a survey-weighted log-rank test to assess statistical differences between the survival curves in this specific subset of the data. The process is the same as the main analysis.\n\n**Kaplan-Meier Survival Curves** \n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/subPlot_45fa6d9d2b7aa3c51ff4577116dae692'}\n\n```{.r .cell-code}\ndummy_sub <- length(unique(as.factor(w.design.2.0$variables$exposure.cat)))\n\n# Define the survival formula for Kaplan-Meier plot and log-rank test\nformulax0_sub <- as.formula(Surv(stime.since.birth, status_all) ~ exposure.cat)\n\n# Calculate survey-weighted Kaplan-Meier curves for the sub-period\nsA_sub<-svykm(formulax0_sub, design=w.design.2.0)\n\n# Plot\npar(oma=rep(0,4))\npar(mar=c(5,4,0,0) + 0.1)\nplot(sA_sub, pars=list(col=c(1:dummy_sub)),\n     xlab = \"Time\",\n     ylab = \"Proportion surviving\")\nlegend(\"bottomleft\", levels(as.factor(w.design.2.0$variables$exposure.cat)),\n       col = (1:dummy_sub), lty = c(1,1))\n```\n\n::: {.cell-output-display}\n![Sensitivity Analysis 2: Survey-Weighted Kaplan-Meier Curves](images/sub/subPlot-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n**Log-Rank Test**\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/sub-logrank_9a053d64b64033024b779e9be7991736'}\n\n```{.r .cell-code}\n# Perform the survey-weighted log-rank test\nlrt_sub <- svylogrank(formulax0_sub,design=subset(w.design.2.0, survey.weight.new>0))\nround(lrt_sub[[2]],2)\n#> Chisq     p \n#> 40.71  0.00\n```\n:::\n\n\n\n---\n\n**Cox Proportional Hazards Models**\n\n\n* R Code Chunk 10 : Unadjusted Cox Proportional Hazards Models for Sub-period\n\nThe following code runs both unweighted (`coxph`) and survey-weighted (`svycoxph`) unadjusted Cox proportional hazards models on the sub-period data. These models serve as a baseline for comparison within this specific sensitivity analysis.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/unadjusted_31c7958ea7f593b3961de45c0d1249ea'}\n\n```{.r .cell-code}\n# Unweighted Cox model for sub-period\nfit0 <- coxph(Surv(stime.since.birth, status_all) ~ exposure.cat, \n              data = dat.complete.2) \n\n# Survey-weighted unadjusted Cox model for sub-period\nfit0 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat, \n                 design = w.design.2.0) # Using w.design.2.0\nf0 <- publish(fit0)\n\n# Process unadjusted HRs for sub-period (similar to main analysis f0r)\nf0r <- f0$regressionTable[2:6,c(\"HazardRatio\",\"CI.95\")] \nf0r$group <- \"Crude (Sub-period)\"\nci_f0_sub <- str_extract_all(f0r[,2], '\\\\d+([.,]\\\\d+)?', simplify = TRUE)\nf0r$CI.l <- as.numeric(as.character(ci_f0_sub[,1]))\nf0r$CI.u <- as.numeric(as.character(ci_f0_sub[,2]))\nnames(f0r) <- c(\"mean\",\"CI.95\",\"group\",\"lower\",\"upper\")\nf0r \n```\n:::\n\n\n\n---\n\n* R Code Chunk 11: Adjusted Cox Proportional Hazards Model for Sub-period\n\nThe following code fits the adjusted Cox proportional hazards model for the sub-period data, controlling for `sex`, `race2`, and `year.cat`.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/adjusted_6f498558c4cdeb03509c446359318369'}\n\n```{.r .cell-code}\n# Survey-weighted adjusted Cox model for sub-period\nfit1 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat + sex + race2 + year.cat,\n                 design = w.design.2.0) \nf1 <- publish(fit1)\n\n# Process adjusted HRs for sub-period (similar to main analysis f1r)\nf1r <- f1$regressionTable[2:6,c(\"HazardRatio\",\"CI.95\")]\nf1r$group <- \"Adjusted (Sub-period)\"\nci_f1_sub <- str_extract_all(f1r[,2], '\\\\d+([.,]\\\\d+)?', simplify = TRUE)\nf1r$CI.l <- as.numeric(as.character(ci_f1_sub[,1]))\nf1r$CI.u <- as.numeric(as.character(ci_f1_sub[,2]))\nnames(f1r) <- c(\"mean\",\"CI.95\",\"group\",\"lower\",\"upper\")\nf1r \n```\n:::\n\n\n\n---\n\n* R Code Chunk 12: Effect Modification by Race/Ethnicity in Sub-period (Model)\n\nThe following code fits the core model for the sub-period sensitivity analysis: a survey-weighted Cox proportional hazards model with an interaction term between `exposure.cat` and `race2`.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/subEM-race2_8c7b708166fbcf0c72a073537b36c69d'}\n\n```{.r .cell-code}\n# Model\nfit2 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat*race2 + sex  + year.cat,\n                           design = w.design.2.0) # Using w.design.2.0\nf2 <- publish(fit2)\n\n# Process Race-Specific Hazard Ratios for Sub-period Plotting\nf2rW <- f2$regressionTable[31:35,c(\"HazardRatio\",\"CI.95\")]\nf2rB <- f2$regressionTable[36:40,c(\"HazardRatio\",\"CI.95\")]\nf2rH <- f2$regressionTable[41:45,c(\"HazardRatio\",\"CI.95\")]\nf2rA <- f2$regressionTable[46:50,c(\"HazardRatio\",\"CI.95\")]\n# Assign group labels\nf2rW$group <- \"White (Sub-period)\"\nf2rB$group <- \"Black (Sub-period)\"\nf2rH$group <- \"Hispanic (Sub-period)\"\nf2rA$group <- \"Asian (Sub-period)\"\nf2r <- rbind(f2rW, f2rB, f2rH, f2rA)\nci <- str_extract_all(f2r[,2], '\\\\d+([.,]\\\\d+)?', simplify = TRUE)\nf2r$CI.l <- as.numeric(as.character(ci[,1]))\nf2r$CI.u <- as.numeric(as.character(ci[,2]))\nnames(f2r) <- c(\"mean\",\"CI.95\",\"group\",\"lower\",\"upper\")\nf2r\n```\n:::\n\n\n\n---\n\n* R Code Chunk 13: Effect Modification by Sex in Sub-period (Model)\n\nThe following code fits a survey-weighted Cox proportional hazards model, including an interaction term between `exposure.cat` and `sex` for the sub-period data.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/subEM-sex_7e9c60255af2dc857399e541bea64111'}\n\n```{.r .cell-code}\nfit3 <- svycoxph(Surv(stime.since.birth, status_all) ~ exposure.cat*sex + race2 + year.cat, # Using fit3\n                 design = w.design.2.0) \nf3 <- publish(fit3)\n\n# Process Sex-Specific Hazard Ratios for Sub-period Plotting\nf3rM <- f3$regressionTable[16:20,c(\"HazardRatio\",\"CI.95\")]\nf3rF <- f3$regressionTable[21:25,c(\"HazardRatio\",\"CI.95\")]\n\nf3rM$group <- \"Male (Sub-period)\"\nf3rF$group <- \"Female (Sub-period)\"\nf3r <- rbind(f3rM, f3rF)\nci <- str_extract_all(f3r[,2], '\\\\d+([.,]\\\\d+)?', simplify = TRUE)\nf3r$CI.l <- as.numeric(as.character(ci[,1]))\nf3r$CI.u <- as.numeric(as.character(ci[,2]))\nnames(f3r) <- c(\"mean\",\"CI.95\",\"group\",\"lower\",\"upper\")\n```\n:::\n\n\n\n---\n\n### Visualizing the Sub-period Results\n\n* R Code Chunk 14: Plot\n\nThe following code creates the plot using `ggplot2` and corresponds to _Appendix Figure 4_ in section C.1, Sensitivity analysis with ‘Asian’ category, part of the supplementary materials published with the original paper.\n\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/forest-plot_f602f92d1deddde7211c0982f16fdfb2'}\n\n```{.r .cell-code}\nfr <- rbind(f2r)\nfr <- as.data.frame(fr)\nfr[,c(1,4,5)] <- sapply(fr[,c(1,4,5)], as.numeric)\nfr$age.grp <- c(\"Started before 10\", \"Started at 10-14\", \"Started at 15-17\",\n                \"Started at 18-20\", \"Started after 20\")\n# Change levels\nfr$group <- fct_recode(fr$group,\n  \"Non-Hispanic White\" = \"White (Sub-period)\",\n  \"Non-Hispanic Black\" = \"Black (Sub-period)\",\n  \"Hispanic\"           = \"Hispanic (Sub-period)\",\n  \"Asian\"              = \"Asian (Sub-period)\"\n)\n\n# Re-order\nfr$age.grp <- factor(fr$age.grp,\n                     levels = c(\"Started before 10\",\n                                \"Started at 10-14\",\n                                \"Started at 15-17\",\n                                \"Started at 18-20\",\n                                \"Started after 20\"))\n\nfr$group <- factor(fr$group, levels = c(\"Asian\", \"Hispanic\", \n                                        \"Non-Hispanic Black\", \"Non-Hispanic White\"))\n\n# Plot\nggplot(fr, aes(x = mean, y = group, colour = age.grp)) + \n  geom_vline(xintercept = 1, linetype = \"dashed\", color = \"grey\") +\n  geom_errorbar(aes(xmax = lower, xmin = upper), position = \"dodge\") + \n  geom_point(position = position_dodge(0.9)) + \n  labs(x = \"Hazard Ratio\", y = \"\", \n       legend=TRUE, col = \"Age group\") +\n  theme_classic() +\n  theme(panel.grid.major.x = element_blank(),\n        panel.border = element_blank(),\n        legend.title=element_text(size=12), \n        legend.text=element_text(size=12),\n        plot.title = element_text(hjust = 0),\n        axis.text.x = element_text(size = 10, face = \"bold\"),\n        axis.text.y = element_text(size = 10, face = \"bold\"),\n        legend.position=c(.8, .8))\n```\n\n::: {.cell-output-display}\n![Appendix Figure 4: Forest plot of Hazard Ratios from the sensitivity analysis with ‘Asian’ category.](images/sub/forest-plot-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggsave(\"images/forest2.png\")\n```\n:::\n\n\n\nThis concludes the sensitivity analysis.\n\n\n<hr style=\"border: none; border-top: 3px solid black; width: 100%; margin-top: 1em; margin-bottom: 1em;\">\n\n\n## Appendix B: Exploratory Analysis of Smoking Duration\n\nAs noted in the main paper, the duration of smoking is a potential mediator in the pathway from early smoking initiation to mortality. To investigate this secondary relationship, we create boxplots to visualize smoking duration across the different age-of-initiation categories. The following analysis uses the data we set aside earlier (`dat.analytic.duration.analysis`). This analysis reproduces Appendix Figures 1, 2, and 3 from the paper.\n\n**NOTE**: This analysis is based on participants from 1999-2016, as the variable for age of smoking cessation (`SMD055`) was not collected in the 2017-2018 cycle.\n\n### Data Preparation for Duration Plots\n\n* R Code Chunk 1: Prepare Data for Duration Analysis\n\nThe following code processes the data to calculate smoking duration by cleaning the age variables, computing the difference, correcting for data entry errors, and saving the final, plot-ready dataset.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/create-duration-data_638c173a40cf1f4c8951bef534990026'}\n\n```{.r .cell-code}\n# Clean the 'smoking.age' variable before calculation.\n# Recode 0 and 99 (codes for never-smokers) to NA.\ndat.analytic.duration.analysis$smoking.age[dat.analytic.duration.analysis$smoking.age == 0] <- NA\ndat.analytic.duration.analysis$smoking.age[dat.analytic.duration.analysis$smoking.age == 99] <- NA\n\n# Calculate smoking duration.\ndat.analytic.duration.analysis$smoking.duration <- dat.analytic.duration.analysis$smoking.quit.age - dat.analytic.duration.analysis$smoking.age\n\n# Correct any negative durations (from data entry errors) to 0.\ndat.analytic.duration.analysis$smoking.duration[!is.na(dat.analytic.duration.analysis$smoking.duration) & dat.analytic.duration.analysis$smoking.duration < 0] <- 0\n\n# Run the original summary checks to explore the new variable.\ncat(\"Total number of participants with non-missing smoking duration data:\\n\")\n#> Total number of participants with non-missing smoking duration data:\nprint(sum(!is.na(dat.analytic.duration.analysis$smoking.duration)))\n#> [1] 8916\n\ncat(\"\\nSummary of smoking duration for all ever-smokers:\\n\")\n#> \n#> Summary of smoking duration for all ever-smokers:\nprint(summary(dat.analytic.duration.analysis$smoking.duration))\n#>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n#>    0.00    8.00   18.00   19.99   30.00   68.00   41908\n\n# Create the final data frame for plotting by filtering out non-smokers.\ndat.analytic.plot <- dat.analytic.duration.analysis %>% \n  filter(!exposure.cat %in% c(\"Never smoked\", NA))\n\n# Save the final plot-ready data.\nsaveRDS(dat.analytic.plot, file = \"data/duration_plot_data.rds\")\n```\n:::\n\n\n\n---\n\n### Visualizing Smoking Duration by Initiation Age\n\n* R Code Chunk 2: Smoking Duration Plots\n\nNow, the following code uses the `dat.analytic.plot` data version to calculate the median smoking duration for each exposure category, which will be used to draw a trend line on the plots.\n\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/median_58b93fe8590da43bae0ef84cf8755d16'}\n\n```{.r .cell-code}\n# Pre-calculate medians for the trend line\nmedian_data <- dat.analytic.plot %>%\n  group_by(exposure.cat) %>%\n  summarize(median = median(smoking.duration, na.rm = TRUE)) %>%\n  arrange(factor(exposure.cat, levels = c('Started before 10',\n                                         'Started at 10-14',\n                                         \"Started at 15-17\",\n                                         \"Started at 18-20\",\n                                         \"Started after 20\")))\n```\n:::\n\n\n\nThe following code chunks generate the three plots corresponding to **Appendix Figures 1, 2, and 3** in the paper's supplementary material.\n\n**Appendix Figure 1: Overall Smoking Duration**\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/app-plot1_5e26e92d853604e58330f9704e2383fd'}\n\n```{.r .cell-code}\nggplot(dat.analytic.plot, aes(x = exposure.cat, y = smoking.duration, group = exposure.cat)) +\n  geom_boxplot(fill = \"white\") +\n  geom_line(data = median_data, aes(x = exposure.cat, y = median, group = 1), color = \"grey\", size = 2, linetype = 2) +\n  geom_smooth(method = \"loess\", se = TRUE, color = \"blue\", size = 1, span = 0.5, level = 0.8) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  labs(x = \"\", y = \"Smoking Duration (Years)\",\n       title = \"Boxplot of Smoking Duration by Exposure Category\")\n```\n\n::: {.cell-output-display}\n![Smoking duration by age of initiation category among ever-smokers.](images/sub/app-plot1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n**Appendix Figure 2: Stratified by Sex**\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/app-plot2_1e6b2e042fc57968348d29fb08e04f9f'}\n\n```{.r .cell-code}\nggplot(dat.analytic.plot, aes(x = exposure.cat, y = smoking.duration, group = exposure.cat)) +\n  geom_boxplot(fill = \"white\") +\n  geom_line(data = median_data, aes(x = exposure.cat, y = median, group = 1), color = \"grey\", size = 2, linetype = 2) +\n  geom_smooth(method = \"loess\", se = TRUE, color = \"blue\", size = 1, span = 0.5, level = 0.8) +\n  facet_wrap(~sex) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  labs(x = \"\", y = \"Smoking Duration (Years)\",\n       title = \"Boxplot of Smoking Duration by Exposure Category\")\n```\n\n::: {.cell-output-display}\n![](images/sub/app-plot2-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n**Appendix Figure 3: Stratified by Race/Ethnicity**\n\n\n::: {.cell hash='10-sensitivity-analysis_cache/pdf/app-plot3_bdd95d3d9cb285ac5039576266073e4e'}\n\n```{.r .cell-code}\nlevels(dat.analytic.plot$race)[levels(dat.analytic.plot$race) == \"White\"] <- \"Non-Hispanic White\"\nlevels(dat.analytic.plot$race)[levels(dat.analytic.plot$race) == \"Black\"] <- \"Non-Hispanic Black\"\n\nggplot(dat.analytic.plot, aes(x = exposure.cat, y = smoking.duration, group = exposure.cat)) +\n  geom_boxplot(fill = \"white\") +\n  geom_line(data = median_data, aes(x = exposure.cat, y = median, group = 1), color = \"grey\", size = 2, linetype = 2) +\n  geom_smooth(method = \"loess\", se = TRUE, color = \"blue\", size = 1, span = 0.5, level = 0.8) +\n  facet_wrap(~race) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  ) +\n  labs(x = \"\", y = \"Smoking Duration (Years)\",\n       title = \"Boxplot of Smoking Duration by Exposure Category\")\n```\n\n::: {.cell-output-display}\n![](images/sub/app-plot3-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n### Interpretation of Results\n\nThe boxplots consistently show a clear inverse relationship. The median smoking duration (indicated by the grey dashed line) is highest for those who started smoking before age 10 and steadily decreases for groups that started later in life. This trend holds true when the data is stratified by both sex and race/ethnicity. This visual evidence supports the hypothesis that **earlier smoking initiation leads to a longer cumulative exposure to tobacco**, which is a likely mediator in the pathway to increased mortality risk.\n\n\n## Chapter Summary and Next Steps\n\nWe have now completed two important sensitivity analyses to test the robustness of our primary findings. First, we adjusted for socioeconomic status proxies, and second, we re-ran the effect modification analysis on the 2011-2018 data to include the non-Hispanic Asian category. The results from both analyses were largely consistent with the main findings, strengthening our confidence in the conclusions.\n\nWe also completed the exploratory analysis which suggested a potential mechanism for our findings, showing that earlier smoking initiation is strongly associated with a longer lifetime smoking duration.\n\nWith the analytical portion complete, the next chapter, \"Discussion of Results,\" will synthesize the findings from all analyses and interpret their meaning.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}